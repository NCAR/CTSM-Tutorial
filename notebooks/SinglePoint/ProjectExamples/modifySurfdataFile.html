

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Modify Surfacedataset File &#8212; CTSM Mini-tutorial 2022</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=ac02cc09edc035673794" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=ac02cc09edc035673794" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794" />
  <script src="../../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=ac02cc09edc035673794"></script>

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/SinglePoint/ProjectExamples/modifySurfdataFile';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../../README.html">
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/ncar_logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../../_static/ncar_logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorial FAQ</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../faq.html">Frequently Asked Questions (FAQ)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/NCAR/CTSM-Tutorial-2022/master?urlpath=tree/docs/notebooks/SinglePoint/ProjectExamples/modifySurfdataFile.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/NCAR/CTSM-Tutorial-2022" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/NCAR/CTSM-Tutorial-2022/edit/master/docs/notebooks/SinglePoint/ProjectExamples/modifySurfdataFile.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/NCAR/CTSM-Tutorial-2022/issues/new?title=Issue%20on%20page%20%2Fnotebooks/SinglePoint/ProjectExamples/modifySurfdataFile.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/notebooks/SinglePoint/ProjectExamples/modifySurfdataFile.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Modify Surfacedataset File</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#open-the-surface-dataset">1. Open the surface dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lots-of-data-goes-into-the-surface-dataset">Lots of data goes into the surface dataset.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#changing-the-dominant-pft">2. Changing the dominant PFT</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modify-lai-for-a-pft-sp-simulations-only">3. Modify LAI for a PFT (SP simulations only)</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="modify-surfacedataset-file">
<h1>Modify Surfacedataset File<a class="headerlink" href="#modify-surfacedataset-file" title="Permalink to this heading">#</a></h1>
<ul>
<li><p>This notebook is designed to open and modify one or several fields on a NEON surface dataset.</p></li>
<li><p>It’s easier to run if you’ve made a local copy of the surface dataset somewhere in your working directory.</p></li>
<li><p>You can find the surface dataset by looking at your <code class="docutils literal notranslate"><span class="pre">lnd_in</span></code> file from a case directory on the command line.</p>
<blockquote>
<div><p>e.g. <code class="docutils literal notranslate"><span class="pre">cat</span> <span class="pre">~/scratch/NEON_cases/KONZ.transient/run/lnd_in</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">fsurdat</span></code></p>
</div></blockquote>
</li>
<li><p>Then I created a copy of this parameter file here (~/scratch/NEON_cases/modified_inputs/.)</p>
<blockquote>
<div><p>on Cheyenne: <code class="docutils literal notranslate"><span class="pre">cp</span> <span class="pre">/glade/p/cesmdata/cseg/inputdata/lnd/clm2/surfdata_map/NEON/surfdata_1x1_NEON_KONZ_hist_78pfts_CMIP6_simyr2000_c230111.nc</span>&#160; <span class="pre">~/scratch/NEON_cases/modified_inputs.</span></code></p>
</div></blockquote>
</li>
</ul>
<p>The most common thing you may want to change on the surface dataset is the plant functional type for a site, or the leaf area index (if you’re running an satelite phenology (SP) case.</p>
<ul class="simple">
<li><p>You can see what the default pft is using the following code on the command line</p></li>
</ul>
<blockquote>
<div><p>on Cheyenne: <code class="docutils literal notranslate"><span class="pre">ncdump</span> <span class="pre">-v</span> <span class="pre">PCT_NAT_PFT</span> <span class="pre">/glade/p/cesmdata/cseg/inputdata/lnd/clm2/surfdata_map/NEON/surfdata_1x1_NEON_KONZ_hist_78pfts_CMIP6_simyr2000_c230111.nc</span></code></p>
</div></blockquote>
<p><strong>In cloud we can make a local copy to work with</strong>  <em>NOTE</em> since this is a python notebook our bash commands will look a little different.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span><span class="w"> </span>cat<span class="w"> </span>~/scratch/NEON_cases/KONZ.transient/run/lnd_in<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>fsurdat
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span><span class="w"> </span>mkdir<span class="w"> </span>/scratch/<span class="si">${</span><span class="nv">USER</span><span class="si">}</span>/NEON_cases/modified_inputs/<span class="w">  </span>#<span class="w"> </span>Directory<span class="w"> </span>to<span class="w"> </span>save<span class="w"> </span>the<span class="w"> </span>file
<span class="o">!</span><span class="w"> </span>cp<span class="w"> </span>/scratch/inputdata/lnd/clm2/surfdata_map/NEON/surfdata_1x1_NEON_KONZ_hist_78pfts_CMIP6_simyr2000_c230111.nc<span class="w"> </span>/scratch/<span class="si">${</span><span class="nv">USER</span><span class="si">}</span>/NEON_cases/modified_inputs/.
</pre></div>
</div>
</div>
</div>
<p>This tutorial has 3 parts:</p>
<ol class="arabic simple">
<li><p>Open the surface dataset</p></li>
<li><p>Change the dominant plant functional type (PFT).</p></li>
<li><p>Modify leaf area index (LAI) for the dominant PFT (for SP cases only).</p></li>
</ol>
<p>Created by Will Wieder May 2023</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load libraries</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">netCDF4</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<section id="open-the-surface-dataset">
<h2>1. Open the surface dataset<a class="headerlink" href="#open-the-surface-dataset" title="Permalink to this heading">#</a></h2>
<p>As mentioned above, I’ve alreay copied the file to a local directory.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pathin</span> <span class="o">=</span> <span class="s1">&#39;~/scratch/NEON_cases/modified_inputs/&#39;</span>
<span class="n">basefile</span> <span class="o">=</span> <span class="n">pathin</span> <span class="o">+</span> <span class="s1">&#39;surfdata_1x1_NEON_KONZ_hist_78pfts_CMIP6_simyr2000_c230111.nc&#39;</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">basefile</span><span class="p">,</span><span class="n">decode_times</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> 
<span class="n">s</span><span class="o">.</span><span class="n">var</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="lots-of-data-goes-into-the-surface-dataset">
<h2>Lots of data goes into the surface dataset.<a class="headerlink" href="#lots-of-data-goes-into-the-surface-dataset" title="Permalink to this heading">#</a></h2>
<p>It’s too much for us to go over here. Hopefully between the <a class="reference external" href="https://escomp.github.io/ctsm-docs/versions/master/html/index.html">user’s guide and tech note</a> find what you need to regarding surface data.</p>
<p>In the NEON cases we set a dominant PFT for each site and modified soil properties to reflect NEON megapit measurements.
The real ecosystems at NEON sites, however, have multiple plant functional types represented in the tower footprint or region.  For example, mixed deciduous and evergreen forests, grassland - forest savannahs, mixed grasslands and woody shrublands, or a mix of C3 and C4 grasses.  Users can set the PFT mixtures to reflect local conditions, although this makes it difficult to understand individual PFT’s contributions to the gridcell weighted fluxes we typically look at.</p>
<p>For now, we’ll just look at how to change the single dominant PFT at a site.</p>
</section>
<section id="changing-the-dominant-pft">
<h2>2. Changing the dominant PFT<a class="headerlink" href="#changing-the-dominant-pft" title="Permalink to this heading">#</a></h2>
<p>For example, the surface datset  <code class="docutils literal notranslate"><span class="pre">PCT_NAT_PFT</span></code> defines the percent plant functional type on the natural vegetated landunit.</p>
<ul class="simple">
<li><p>What is the dominant PFT index at KONZ?</p></li>
<li><p>What PFT does this correspond to in the model?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">PCT_NAT_PFT</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s imagine that you studied plant composition at the KONZ site and found a there are a number of C3 and C4 grasses in the tower footprint.  We can modify the surface dataset to see what a C3 grass (pft 13) simulation looks like at KONZ.</p>
<p>To do thsi, we’ll create a new surface data file, change values for <code class="docutils literal notranslate"><span class="pre">PCT_NAT_PFT</span></code>, and save the new file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s2</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>         <span class="c1"># create a copy of the surface dataset to modify</span>
<span class="n">s2</span><span class="p">[</span><span class="s1">&#39;PCT_NAT_PFT&#39;</span><span class="p">][[</span><span class="mi">13</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">100.</span> <span class="c1"># set C3 grasses to 100</span>
<span class="n">s2</span><span class="p">[</span><span class="s1">&#39;PCT_NAT_PFT&#39;</span><span class="p">][[</span><span class="mi">14</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">0.</span>   <span class="c1"># set C4 grasses to 0</span>
<span class="n">s2</span><span class="p">[</span><span class="s1">&#39;PCT_NAT_PFT&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>              <span class="c1"># check that it worked as intended</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># now save the file</span>
<span class="n">s2</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">pathin</span> <span class="o">+</span> <span class="s1">&#39;surfdata_1x1_NEON_KONZ_hist_78pfts_CMIP6_simyr2000_c230111_C3grass.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>You’ll notice this is a non-standard way to modify surface dataset in in CTSM.  It’s really just designed for quick experiments:</p>
<ul class="simple">
<li><p>I like to make the name descriptive so I remember what I changed.</p></li>
</ul>
</section>
<section id="modify-lai-for-a-pft-sp-simulations-only">
<h2>3. Modify LAI for a PFT (SP simulations only)<a class="headerlink" href="#modify-lai-for-a-pft-sp-simulations-only" title="Permalink to this heading">#</a></h2>
<p>For this example, let’s assume you derived a climatology of LAI from NEON or remote sensing data products.  This would be a huge help, because the values being used in CLM in global simulations are likely not representative of local  conditions at NEON sites.</p>
<div class="alert alert-block alert-warning">
<p><b>HINT:</b>  It’s a good idea to check what PFT is actually on the surface dataset for the site you’re running.</p>
</div>
<p>Let’s see what LAI looks like</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s2</span><span class="o">.</span><span class="n">PCT_NAT_PFT</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">natpft</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is a hacky way to look at the LAI timeseries and identify the dominant PFT at a site</span>
<span class="n">NATPFT</span> <span class="o">=</span> <span class="n">s2</span><span class="o">.</span><span class="n">PCT_NAT_PFT</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">natpft</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;natpft&quot;</span><span class="p">:</span><span class="s1">&#39;lsmpft&#39;</span><span class="p">})</span>
<span class="p">(</span><span class="n">s2</span><span class="o">.</span><span class="n">MONTHLY_LAI</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">lsmpft</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span><span class="o">*</span><span class="n">NATPFT</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="s1">&#39;lsmpft&#39;</span><span class="p">)</span> <span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<p>If you want to modify the LAI of your PFT we can discuss different ways to do this, but it would be really helpful to have NEON data that can help inform this.</p>
<hr class="docutils" />
<div class="alert alert-block alert-success">
<b>Congratulations:</b> 
<p>You can now modify parameter files!<br />
Remember, to run with one of these you’ll have to spin up the model first.</p>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/SinglePoint/ProjectExamples"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#open-the-surface-dataset">1. Open the surface dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lots-of-data-goes-into-the-surface-dataset">Lots of data goes into the surface dataset.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#changing-the-dominant-pft">2. Changing the dominant PFT</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modify-lai-for-a-pft-sp-simulations-only">3. Modify LAI for a PFT (SP simulations only)</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Negin Sobhani, Danica Lombardozzi, Adrianna Foster, Will Wieder
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=ac02cc09edc035673794"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>